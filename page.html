<!DOCTYPE html>
<html lang="zh-cn">
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">  
	<meta name="apple-mobile-web-app-capable" content="yes" />    
	<meta charset="UTF-8">
	<title>图片加载器</title>
	<style>
		html,body{
			margin:0;
			padding:0;
			height:100%;
			overflow: hidden;
		}
		.container{
			min-height:100%;
			height:100%;
			background:#fff;
		}
		.page-section{
			position: relative;
			width:100%;
			height:100%;
			display: none;
			overflow: hidden;
			text-align: center;
			background-size:100%;
		}
		.page-section.animate{
			transition: margin 480ms cubic-bezier(0.42, 0, 0.5, 1.6);
			-moz-transition: margin 480ms cubic-bezier(0.42, 0, 0.5, 1.6); /* Firefox 4 */
			-webkit-transition: margin 480ms cubic-bezier(0.42, 0, 0.5, 1.6); /* Safari 和 Chrome */
			-o-transition: margin 480ms cubic-bezier(0, 1.77, 0, 1.76); /* Opera */
		}
		.page-section .page-blur{
			position: absolute;
			top:0;
			right:0;
			bottom:0;
			left:0;
			-webkit-filter: blur(2px);
            -moz-filter: blur(2px);
            -o-filter: blur(2px);
            -ms-filter: blur(2px);
            filter: blur(2px);
            opacity: 0.45;
            z-index:98;

            background-size:100% 100%;
			background-repeat: no-repeat;
		}
		.page-section img.page-image{
			position: relative;
			width:100%;
			z-index:99;
		}
		.pagecount{
			position: fixed;
			bottom:5px;
			right:5px;
			color:#fff;
			font-weight:100;
			z-index:100;
			font-size:12px;
		}
	</style>
</head>
<body>
	<div class="container">
		
	</div>
	<div class="pagecount">1/10</div>
	<script type="text/javascript" src="jquery-2.1.3.min.js"></script>
	<script type="text/javascript" src="mevent.js"></script>
	<script>
		(function(){
			var imgList = ['1.jpg','2.jpg','3.jpg','4.jpg','5.jpg','index.jpg'];
			var currentPage = 0;
			var imagePage = 0;
			var container = $(".container");
			var wh = $(window).height();

			var countEle = $(".pagecount");

			var addPage = function(){
				if(imagePage<=currentPage && imagePage<imgList.length){
					var myImage = new Image();

					myImage.onload =function(){
						var section = 
							$("<div>")
								.addClass('page-section')
								.appendTo(container);

						$("<div>")
							.addClass('page-blur')
							.css({
								"background-image":"url("+this.src+")"
							})
							.appendTo(section);
						$(this)
							.addClass('page-image')
							.appendTo(section.fadeIn(680));
					}
					myImage.src=imgList[imagePage];
					imagePage++;
				}
			};


			//监听向下滚动事件
			var a= new ztmEvent($("html")[0])
			a.on("swipeUp",function(a,b,c){
				if(currentPage<imgList.length-1 && c>130){
					currentPage++;
					container.children(".page-section").eq(0)
						.addClass('animate')
						.css({
							"margin-top":-wh*currentPage+"px"
						});
					showCurrentCount();
					addPage();	
				}
				else{
					container.children(".page-section").eq(0)
						.addClass('animate')
						.css({
							"margin-top":-wh*currentPage+"px"
						});
				}
			
			});
			a.on("swipeDown",function(a,b,c){
				if(currentPage>0 && c>130){
					currentPage--;
					container.children(".page-section").eq(0)
						.addClass('animate')
						.css({
							"margin-top":-wh*currentPage+"px"
						});

					showCurrentCount();
				}
				else{
					container.children(".page-section").eq(0)
						.addClass('animate')
						.css({
							"margin-top":-wh*currentPage+"px"
						});
				}
				
			});

			a.on("swipeUping",function(a,b,c){
				if(currentPage<imgList.length-1){
					container.children(".page-section").eq(0)
						.removeClass('animate')
						.css({
							"margin-top":-(wh*currentPage+c)+"px"
						});
				}
				else{
					alert("大兄弟，没有图片啦！")
				}
				
			})

			a.on("swipeDowning",function(a,b,c){
				if(currentPage>0){
					container.children(".page-section").eq(0)
						.removeClass('animate')
						.css({
							"margin-top":-(wh*currentPage-c)+"px"
						});
				}
				
			})
			addPage();

			var showCurrentCount =function(){
				countEle.text((currentPage+1)+"/"+imgList.length);
			};showCurrentCount();
		}());
	</script>
</body>
</html>